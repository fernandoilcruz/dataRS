aes(x = year,
y = `percent change`
)
) +
geom_line(colour = "darkblue",
alpha = 0.5,
size = 1) +
geom_point(colour = "darkblue") +
ggtitle("Rendimento da produção de soja no Rio Grande do Sul") +
gganimate::transition_reveal(year) +
theme_minimal()
p_anim2 <- animate(rend_estado,
nframes = 31,
#nframes = 500,
#duration = 20,
renderer = gifski_renderer())
a_mgif <- image_read(p_anim1)
b_mgif <- image_read(p_anim2)
new_gif <- image_append(c(a_mgif[1], b_mgif[1]), stack = FALSE)
for(i in 2:31){
combined <- image_append(c(a_mgif[i], b_mgif[i]), stack = FALSE)
new_gif <- c(new_gif, combined)
}
new_gif
p_map1 <-
map_rs |>
ggplot() +
geom_sf(
aes(fill = `percent change`),
color = "white",
size = .15) +
labs(title = "Rendimento Médio da Produção de Soja",
caption = 'Fonte: DataRS', size=8) +
scale_fill_distiller(palette = "RdYlGn",
name="Rendimento",
direction = "horizontal") +
gganimate::transition_manual(year) +
labs( title = "Ano: {current_frame}") +
# transition_states(Ano,transition_length = 10, state_length = 1) +
# labs(title = "Ano: {closest_state}") +
# transition_time(as.integer(Ano)) +
# labs(title = "Ano: {as.integer(frame_time)}") +
theme_minimal()
p_anim1 <- animate(p_map1,
nframes = 500,
#duration = 20,
renderer = gifski_renderer())
p_anim1
map_rs
data_soy_mun
data_soy_mun
p_map1 <-
map_rs |>
ggplot() +
geom_sf(
aes(fill = `percent change`),
color = "white",
size = .15) +
labs(title = "Var. % do Rendimento Médio da Produção de Soja",
caption = 'Fonte: DataRS', size=8) +
scale_fill_distiller(palette = "RdYlGn",
name="Var. % do Rendimento",
direction = "horizontal") +
gganimate::transition_manual(year) +
labs( title = "Ano: {current_frame}") +
# transition_states(Ano,transition_length = 10, state_length = 1) +
# labs(title = "Ano: {closest_state}") +
# transition_time(as.integer(Ano)) +
# labs(title = "Ano: {as.integer(frame_time)}") +
theme_minimal()
p_anim1 <- animate(p_map1,
nframes = 500,
#duration = 20,
renderer = gifski_renderer())
map_rs |>
ggplot() +
geom_sf(
aes(fill = `percent change`),
color = "white",
size = .15) +
labs(title = "Var. % do Rendimento Médio da Produção de Soja",
caption = 'Fonte: DataRS', size=8) +
scale_fill_distiller(palette = "RdYlGn",
name="Var. % do Rendimento",
direction = "horizontal") +
gganimate::transition_manual(year) +
labs( title = "Ano: {current_frame}") +
# transition_states(Ano,transition_length = 10, state_length = 1) +
# labs(title = "Ano: {closest_state}") +
# transition_time(as.integer(Ano)) +
# labs(title = "Ano: {as.integer(frame_time)}") +
theme_minimal()
p_map1 <-
map_rs |>
ggplot() +
geom_sf(
aes(fill = `percent change`),
color = "white",
size = .15) +
labs(title = "Var. % do Rendimento Médio da Produção de Soja",
caption = 'Fonte: DataRS', size=8) +
scale_fill_distiller(palette = "RdYlGn",
name="Var. % do Rendimento",
direction = "horizontal") +
gganimate::transition_manual(year) +
labs( title = "Ano: {current_frame}") +
# transition_states(Ano,transition_length = 10, state_length = 1) +
# labs(title = "Ano: {closest_state}") +
# transition_time(as.integer(Ano)) +
# labs(title = "Ano: {as.integer(frame_time)}") +
theme_minimal()
p_anim1 <- animate(p_map1,
nframes = 500,
#duration = 20,
renderer = gifski_renderer())
p_map1 <-
map_rs |>
ggplot() +
geom_sf(
aes(fill = `percent change`),
color = "white",
size = .15) +
labs(title = "Var. % do Rendimento Médio da Produção de Soja",
caption = 'Fonte: DataRS', size=8) +
scale_fill_distiller(palette = "RdYlGn",
name="Var. % do Rendimento",
direction = "horizontal") +
gganimate::transition_manual(year) +
labs( title = "Ano: {current_frame}") +
# transition_states(Ano,transition_length = 10, state_length = 1) +
# labs(title = "Ano: {closest_state}") +
# transition_time(as.integer(Ano)) +
# labs(title = "Ano: {as.integer(frame_time)}") +
theme_minimal()
p_anim1 <- animate(p_map1,
nframes = 500,
#duration = 20,
renderer = gifski_renderer())
p_anim1
map_rs |>
ggplot() +
geom_sf(
aes(fill = `percent change`),
color = "white",
size = .15) +
labs(title = "Var. % do Rendimento Médio da Produção de Soja",
caption = 'Fonte: DataRS', size = 8) +
scale_fill_distiller(palette = "RdYlGn",
name = "Var. % do Rendimento",
direction = "horizontal") +
gganimate::transition_manual(year) +
labs( title = "Ano: {current_frame}") +
# transition_states(Ano,transition_length = 10, state_length = 1) +
# labs(title = "Ano: {closest_state}") +
# transition_time(as.integer(Ano)) +
# labs(title = "Ano: {as.integer(frame_time)}") +
theme_minimal()
p_map1 <-
map_rs |>
ggplot() +
geom_sf(
aes(fill = `percent change`),
color = "white",
size = .15) +
labs(title = "Var. % do Rendimento Médio da Produção de Soja",
caption = 'Fonte: DataRS', size = 8) +
scale_fill_distiller(palette = "RdYlGn",
name = "Var. % do Rendimento",
direction = "horizontal") +
gganimate::transition_manual(year) +
labs( title = "Ano: {current_frame}") +
# transition_states(Ano,transition_length = 10, state_length = 1) +
# labs(title = "Ano: {closest_state}") +
# transition_time(as.integer(Ano)) +
# labs(title = "Ano: {as.integer(frame_time)}") +
theme_minimal()
p_anim1 <- animate(p_map1,
nframes = 500,
#duration = 20,
renderer = gifski_renderer())
map_rs |>
ggplot() +
geom_sf(
aes(fill = `percent change`),
color = "white",
size = .15) +
labs(title = "Var. % do Rendimento Médio da Produção de Soja",
caption = 'Fonte: DataRS', size = 8) +
scale_fill_distiller(palette = "RdYlGn",
name = "Var. % do Rendimento",
direction = "horizontal")
map_rs
map_rs |>
ggplot() +
geom_sf(
aes(fill = `percent change`),
color = "white",
size = .15) +
labs(title = "Var. % do Rendimento Médio da Produção de Soja",
caption = 'Fonte: DataRS', size = 8) +
scale_fill_distiller(palette = "RdYlGn",
name = "Var. % do Rendimento",
direction = "horizontal")
map_rs |>
ggplot() +
geom_sf(
aes(fill = `percent change`),
color = "white",
size = .15) +
labs(title = "Var. % do Rendimento Médio da Produção de Soja",
caption = 'Fonte: DataRS', size = 8) +
scale_fill_distiller(palette = "RdYlGn",
name = "Var. % do Rendimento",
direction = "horizontal") + facet_wrap(~year)
map_rs |>
ggplot() +
geom_sf(
aes(fill = `percent change`),
color = "white",
size = .15) +
labs(title = "Var. % do Rendimento Médio da Produção de Soja",
caption = 'Fonte: DataRS', size = 8) +
scale_fill_distiller(palette = "RdYlGn",
name = "Var. % do Rendimento",
direction = "horizontal") + facet_wrap(~year)
p_map1 <-
map_rs |>
ggplot() +
geom_sf(
aes(fill = `percent change`),
color = "white",
size = .15) +
labs(title = "Var. % do Rendimento Médio da Produção de Soja",
caption = 'Fonte: DataRS', size = 8) +
scale_fill_distiller(palette = "RdYlGn",
name = "Var. % do Rendimento",
direction = "horizontal") +
gganimate::transition_manual(year) +
labs( title = "Ano: {current_frame}") +
# transition_states(Ano,transition_length = 10, state_length = 1) +
# labs(title = "Ano: {closest_state}") +
# transition_time(as.integer(Ano)) +
# labs(title = "Ano: {as.integer(frame_time)}") +
theme_minimal()
p_anim1 <- animate(p_map1,
nframes = 500,
#duration = 20,
renderer = gifski_renderer())
p_anim1
p_map1
map_rs
data_soy_mun
data_soy_mun
data_soy_mun |> tail()
data_soy_mun |> filter(geo_name == "Porto Alegre")
data_soy_mun <-
dataRS::getdata(var_id = soy_id,
ag = "municipio",
period = "all",
add_labels = TRUE) |>
group_by(geo_id) |>
dplyr::mutate(
`percent change` = 100*((value-dplyr::lag(value))/(dplyr::lag(value)))
)
data_soy_state <-
dataRS::getdata(var_id = soy_id,
ag = "estado",
period = "all",
add_labels = TRUE) |>
group_by(geo_id) |>
dplyr::mutate(
`percent change` = 100*((value-dplyr::lag(value))/(dplyr::lag(value)))
)
map_rs <-
geobr::read_municipality(
code_muni = "RS",
year = 2020
) |>
dplyr::left_join(
data_soy_mun,
by = c("code_muni" = "geo_id")
)
p_map1 <-
map_rs |>
ggplot() +
geom_sf(
aes(fill = `percent change`),
color = "white",
size = .15) +
labs(title = "Var. % do Rendimento Médio da Produção de Soja",
caption = 'Fonte: DataRS', size = 8) +
scale_fill_distiller(palette = "RdYlGn",
name = "Var. % do Rendimento",
direction = "horizontal") +
gganimate::transition_manual(year) +
labs( title = "Ano: {current_frame}") +
# transition_states(Ano,transition_length = 10, state_length = 1) +
# labs(title = "Ano: {closest_state}") +
# transition_time(as.integer(Ano)) +
# labs(title = "Ano: {as.integer(frame_time)}") +
theme_minimal()
p_anim1 <- animate(p_map1,
nframes = 500,
#duration = 20,
renderer = gifski_renderer())
rend_estado <-
data_soy_state |>
ggplot(
aes(x = year,
y = `percent change`
)
) +
geom_line(colour = "darkblue",
alpha = 0.5,
size = 1) +
geom_point(colour = "darkblue") +
ggtitle("Rendimento da produção de soja no Rio Grande do Sul") +
gganimate::transition_reveal(year) +
theme_minimal()
p_anim2 <- animate(rend_estado,
nframes = 31,
#nframes = 500,
#duration = 20,
renderer = gifski_renderer())
a_mgif <- image_read(p_anim1)
b_mgif <- image_read(p_anim2)
new_gif <- image_append(c(a_mgif[1], b_mgif[1]), stack = FALSE)
for(i in 2:31){
combined <- image_append(c(a_mgif[i], b_mgif[i]), stack = FALSE)
new_gif <- c(new_gif, combined)
}
new_gif
library(devtools)
library(dataRS)
load_all()
library(dataRS)
library(tidyverse)
library(geobr)
library(gganimate)
library(magick)
soy_id <-
dataRS::vars() |>
dplyr::filter(stringr::str_detect(var_name,"Soja") & stringr::str_detect(var_name,"Rendimento")) |>
dplyr::select(var_id) |>
dplyr::pull()
data_soy_mun <-
dataRS::getdata(var_id = soy_id,
ag = "municipio",
period = "all",
add_labels = TRUE) |>
group_by(geo_id) |>
dplyr::mutate(
`percent change` = 100*((value-dplyr::lag(value))/(dplyr::lag(value)))
)
data_soy_state <-
dataRS::getdata(var_id = soy_id,
ag = "estado",
period = "all",
add_labels = TRUE) |>
group_by(geo_id) |>
dplyr::mutate(
`percent change` = 100*((value-dplyr::lag(value))/(dplyr::lag(value)))
)
map_rs <-
geobr::read_municipality(
code_muni = "RS",
year = 2020
) |>
dplyr::left_join(
data_soy_mun,
by = c("code_muni" = "geo_id")
)
p_map1 <-
map_rs |>
ggplot() +
geom_sf(
aes(fill = `percent change`),
color = "white",
size = .15) +
labs(title = "Var. % do Rendimento Médio da Produção de Soja",
caption = 'Fonte: DataRS', size = 8) +
scale_fill_distiller(palette = "RdYlGn",
name = "Var. % do Rendimento",
direction = "horizontal") +
gganimate::transition_manual(year) +
labs( title = "Ano: {current_frame}") +
# transition_states(Ano,transition_length = 10, state_length = 1) +
# labs(title = "Ano: {closest_state}") +
# transition_time(as.integer(Ano)) +
# labs(title = "Ano: {as.integer(frame_time)}") +
theme_minimal()
p_anim1 <- animate(p_map1,
nframes = 500,
#duration = 20,
renderer = gifski_renderer())
rend_estado <-
data_soy_state |>
ggplot(
aes(x = year,
y = `percent change`
)
) +
geom_line(colour = "darkblue",
alpha = 0.5,
size = 1) +
geom_point(colour = "darkblue") +
ggtitle("Rendimento da produção de soja no Rio Grande do Sul") +
gganimate::transition_reveal(year) +
theme_minimal()
p_anim2 <- animate(rend_estado,
nframes = 31,
#nframes = 500,
#duration = 20,
renderer = gifski_renderer())
a_mgif <- image_read(p_anim1)
b_mgif <- image_read(p_anim2)
new_gif <- image_append(c(a_mgif[1], b_mgif[1]), stack = FALSE)
for(i in 2:31){
combined <- image_append(c(a_mgif[i], b_mgif[i]), stack = FALSE)
new_gif <- c(new_gif, combined)
}
new_gif
p_map1 <-
map_rs |>
ggplot() +
geom_sf(
aes(fill = `percent change`),
color = "lightgray",
size = .15) +
labs(title = "Var. % do Rendimento Médio da Produção de Soja",
caption = 'Fonte: DataRS', size = 8) +
scale_fill_distiller(palette = "RdYlGn",
name = "Var. % do Rendimento",
direction = "horizontal") +
gganimate::transition_manual(year) +
labs( title = "Ano: {current_frame}") +
# transition_states(Ano,transition_length = 10, state_length = 1) +
# labs(title = "Ano: {closest_state}") +
# transition_time(as.integer(Ano)) +
# labs(title = "Ano: {as.integer(frame_time)}") +
theme_minimal()
p_anim1 <- animate(p_map1,
nframes = 500,
#duration = 20,
renderer = gifski_renderer())
rend_estado <-
data_soy_state |>
ggplot(
aes(x = year,
y = `percent change`
)
) +
geom_line(colour = "darkblue",
alpha = 0.5,
size = 1) +
geom_point(colour = "darkblue") +
ggtitle("Rendimento da produção de soja no Rio Grande do Sul") +
gganimate::transition_reveal(year) +
theme_minimal()
p_anim2 <- animate(rend_estado,
nframes = 31,
#nframes = 500,
#duration = 20,
renderer = gifski_renderer())
a_mgif <- image_read(p_anim1)
b_mgif <- image_read(p_anim2)
new_gif <- image_append(c(a_mgif[1], b_mgif[1]), stack = FALSE)
for(i in 2:31){
combined <- image_append(c(a_mgif[i], b_mgif[i]), stack = FALSE)
new_gif <- c(new_gif, combined)
}
new_gif
p_map1 <-
map_rs |>
ggplot() +
geom_sf(
aes(fill = `percent change`),
color = "lightgray",
size = .15) +
labs(title = "Var. % do Rendimento Médio da Produção de Soja",
caption = 'Fonte: DataRS', size = 8) +
scale_fill_distiller(palette = "RdYlGn",
name = "Var. % do Rendimento",
direction = "horizontal") + facet_wrap(~year)
p_map1
map_rs
map_rs |>
ggplot() +
geom_sf(
aes(fill = `percent change`),
color = "lightgray",
size = .15) +
labs(title = "Var. % do Rendimento Médio da Produção de Soja",
caption = 'Fonte: DataRS', size = 8)
data_soy_mun
data_soy_mun
data_soy_mun |> arrange(desc(value))
data_soy_mun |> arrange(desc(`percent change`))
library(devtools)
laod_all()
load_all()
my_data<-getdata(var_id=4603,ag ="corede",period=c(2016,2017),add_labels=TRUE,var_name_break=TRUE)
Sys.getenv()
document()
install.packages("roxygen2")
document()
library(devtools)
load_all()
document()
my_data<-getdata(var_id=4603,ag ="corede",period=c(2016,2017),add_labels=TRUE,var_name_break=TRUE)
readRenviron("~/.Renviron")
my_data<-getdata(var_id=4603,ag ="corede",period=c(2016,2017),add_labels=TRUE,var_name_break=TRUE)
