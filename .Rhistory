"&periodo=",
period |> paste0(collapse = ","),
"&sort=",
sort,
"&formato=json"
)
)
paste0(get_url(info = "data"),
"&id=",
z,
"&ag=",
ag,
"&periodo=",
period |> paste0(collapse = ","),
"&sort=",
sort,
"&formato=json"
)
paste0(get_url(info = "data"),
"&id=",
z,
"&ag=",
ag,
"&periodo=",
period |> paste0(collapse = ","),
"&sort=",
sort,
"&formato=json"
)
sort = "ASC"
paste0(get_url(info = "data"),
"&id=",
z,
"&ag=",
ag,
"&periodo=",
period |> paste0(collapse = ","),
"&sort=",
sort,
"&formato=json"
)
x<-
var_id |>
purrr::map_df(function(z){
paste0(get_url(info = "data"),
"&id=",
z,
"&ag=",
ag,
"&periodo=",
period |> paste0(collapse = ","),
"&sort=",
sort,
"&formato=json"
) |>
httr::GET(timeout(1000000), config = config(ssl_verifypeer = 0)) |>
content("text", encoding = "UTF-8") |>
jsonlite::fromJSON() |>
tidyr::unnest(cols = data) |>
dplyr::mutate(var_id = z)
})
x
x <-
x |>
dplyr::rename("geo_id" = "id",
"year" = "ano",
"value" = "valor",
"unit" = "un_medida",
"note" = "nota") |>
dplyr::select(var_id,geo_id,year,value, unit, note)
x
x |>
dplyr::left_join(vars1,
by = c("var_id" = "var_id")) |>
dplyr::left_join(geos1,
by = c("geo_id" = "geo_id")) |>
dplyr::left_join(units1,
by = c("unit" = "um_id")) |>
dplyr::select(var_id, var_name, geo_id, geo_name, year, value, um_name, note) |>
rename(unit = um_name)
vars1 <- vars()
geos1 <- geoagreg(ag = ag)
units1 <- um()
x |>
dplyr::left_join(vars1,
by = c("var_id" = "var_id")) |>
dplyr::left_join(geos1,
by = c("geo_id" = "geo_id")) |>
dplyr::left_join(units1,
by = c("unit" = "um_id")) |>
dplyr::select(var_id, var_name, geo_id, geo_name, year, value, um_name, note) |>
rename(unit = um_name)
x |>
dplyr::left_join(vars1,
by = c("var_id" = "var_id")) |>
dplyr::left_join(geos1,
by = c("geo_id" = "geo_id"))
rm(list=ls())
document()
getdata(var_id = 4603,ag = "corede",period = c(2016,2017), add_labels = TRUE)
getdata(var_id = 4603,ag = "corede",period = c(2016,2017), add_labels = TRUE) |> View9
getdata(var_id = 4603,ag = "corede",period = c(2016,2017), add_labels = TRUE) |> View()
rm(list=ls())
getdata(var_id = 4603,ag = "corede",period = "all")
getdata(var_id = 1686,ag = "corede",period = c(2010:2015))
document()
check()
library(devtools)
load_all()
deetree()
set_api_key("700bc0ff898d2c2977d9a428599be340")
load_all()
deetree()
geoagreg()
geoagreg(ag = "municipio")
geoagreg(ag = "corede", sort = "DESC")
geoagregall2(period = 2010)
geoagregall2()
geoagreg(ag = "meso")
geoagregcomp(ag = "meso", geo_id = 10, period = 2020)
get_api_key()
get_url()
get_url(info = "var")
my_data <- getdata(var_id = 4603,ag = "corede",period = c(2016,2017), add_labels = TRUE)
load_all()
my_data <- getdata(var_id = 4603,ag = "corede",period = c(2016,2017), add_labels = TRUE)
print(my_data)
my_data <- getdata(var_id = 4603,ag = "corede",period = "all")
print(my_data)
source()
load_all()
source()
um()
vardetails(var_id = 4049)
load_all()
vardetails(var_id = 4049)
vardetails(var_id = c(4049,3755,4784))
vardetails(var_id = 4049)
vardetails(var_id = c(4049,3755,4784))
load_all()
vardetails(var_id = c(4049,3755,4784))
vars()
vars(sort = "ASC",filters = "Agricultura")
vars(sort = "ASC",filters = "Agricultura|Educação")
rm(list=ls())
load_all()
devtools:check()
library(devtools)
devtools::check()
rm(list=ls())
document()
load_all()
check()
rm(list=ls())
document()
load_all()
source()
check()
document()
load_all()
check()
document()
load_all()
check()
usethis::use_mit_license("Fernando Cruz")
document()
check()
checking package dependencies ... NOTE
library(devtools)
library(devtools)
check()
document()
check()
document()
document()
check()
document()
check()
usethis::use_vignette("datavisR: user guide")
usethis::use_vignette("datavisR_user_guide")
geoagreg()
geoagregall2()
library(devtools())
library(devtools)
load_all()
geoagregall2()
set_api_key("04108c44ea04c96839fea7c6fe25aabd")
geoagregall2()
vars()
library(devtools)
load_all()
set_api_key("b11e935ee4aedf9d5edcd53e5f1930a9")
#Development version of the package
library(devtools)
devtools::install_github("fernandoilcruz/datavisR")
load_all()
deetree()
vars()
xx<- vars()
xx
help(vars)
vars(filters = "Soja&Rendimento")
vars(filters = "Soja&Rendimento")
vars(filters = "Soja")
vars(filters = "Soja|Rendimento")
vars(filters = "Soja&Rendimento")
vars(filters %in% c("Soja","Rendimento")
vars(filters %in% c("Soja","Rendimento"))
vars(filters = c("Soja","Rendimento"))
vars(filters = "Soja&Rendimento"))
vars(filters = "Soja"& "Rendimento"))
vars(filters = c("Soja"& "Rendimento"))
library(devtools)
load_alla()
load_all()
vars(filters = "Soja&Rendimento")
vars(filters = "Soja")
vars(filters = c("Soja","Rendimento"))
vars(filters %in% c("Soja","Rendimento"))
vars
library(tidyverse)
str_detect_all
rm(list=ls())
load_all()
document()
x<-vars()
x
x |> filter(var_name %in% c("Soja","Rendimento"))
x |> filter(str_detect(var_name c("Soja") & str_detect("Rendimento"))
x |> filter(str_detect(var_name c("Soja") & str_detect(var_name, "Rendimento"))
x |> filter(str_detect(var_name, c("Soja") & str_detect(var_name, "Rendimento"))
x |> filter(str_detect(var_name, c("Soja")) & str_detect(var_name, "Rendimento"))
getdata
user_data <-
datavisR::getdata(
var_id = user_var_id,
ag = "municipio",
period = "all",
add_labels = TRUE
)
#Development version of the package
library(devtools)
devtools::install_github("fernandoilcruz/datavisR")
user_data <-
datavisR::getdata(
var_id = user_var_id,
ag = "municipio",
period = "all",
add_labels = TRUE
)
user_var_id <-
datavisR::vars() |>
dplyr::filter(str_detect(var_name, c("Soja")) & str_detect(var_name, "Rendimento")) |>
dplyr::select(var_id) |>
dplyr::pull()
user_var_id
user_data <-
datavisR::getdata(
var_id = user_var_id,
ag = "municipio",
period = "all",
add_labels = TRUE
)
set_api_key("278c8a820d895f04d1c00805c225b031")
user_data <-
datavisR::getdata(
var_id = user_var_id,
ag = "municipio",
period = "all",
add_labels = TRUE
) |>
dplyr::filter(str_detect(var_name, c("Soja")) & str_detect(var_name, "Rendimento")) |>
dplyr::select(var_id) |>
dplyr::pull()
user_data
user_var_id
user_data <-
datavisR::getdata(
var_id = user_var_id,
ag = "municipio",
period = "all",
add_labels = TRUE
)
user_data
vars()
x
x |> filter(str_detect("Turismo"))
x |> filter(str_detect(var_name,"Turismo"))
x |> tail()
load_all()
document()
document()
load_all()
gemy_data <- getdata(var_id = 4603,ag = "corede",period = c(2016,2017), add_labels = TRUE)
document()
getdata(var_id = 4603,ag = "corede",period = c(2016,2017), add_labels = TRUE)
geoagregall2()
geoagregall2() |> View9
geoagregall2() |> View()
getdata(var_id = 4603,geo_id = 2, ag = "corede",period = "all")
getdata(var_id = 4603,geo_id = 2, ag = "corede",period = "all", add_labels = TRUE)
rm(list=ls())
document()
load_all()
library(devtools)
load_all()
get_api_key()
library(devtools)
load_all()
document()
vars()
vars() |> filter(str_detect("Idese"))
library(tidyverse)
vars() |> filter(str_detect(var_name,"Idese"))
vars() |> dplyr::filter(stringr::str_detect(var_name,"Idese"))
vars()
datavisR::vars()
datavisR::vars() |> dplyr::filter(stringr::str_detect(var_name,"Idese"))
document()
document()
document()
#Development version of the package
library(devtools)
devtools::install_github("fernandoilcruz/datavisR")
#Load the package
library(datavisR)
vars_corede_ex_2013 <-
datavisR::vars() |>
dplyr::filter(
stringr::str_detect(var_name,"Idese"),
stringr::str_detect(string = var_name, pattern = "2013", negate = TRUE))
vars_corede_ex_2013
ids <-
vars_corede_ex_2013 |>
dplyr::select(var_id) |>
dplyr::pull()
datavisR::vardetails(var_id = ids)
set_api_key("f8eb6862a765d8bbf400b6d2bf2be013")
ids <-
vars_corede_ex_2013 |>
dplyr::select(var_id) |>
dplyr::pull()
datavisR::vardetails(var_id = ids)
vars_corede_ex_2013 <-
datavisR::vars() |>
dplyr::filter(
stringr::str_detect(var_name,"Idese"),
stringr::str_detect(string = var_name, pattern = "2013", negate = TRUE))
vars_corede_ex_2013
ids <-
vars_corede_ex_2013 |>
dplyr::select(var_id) |>
dplyr::pull()
datavisR::vardetails(var_id = ids)
data_muni <-
datavisR::getdata(var_id = ids, ag = "municipio", period = "all", add_labels = TRUE) |>
dplyr::mutate(value =
value |>
stringr::str_replace_all(",","\\.") |>
as.numeric())
data_corede <-
datavisR::getdata(var_id = ids, ag = "corede", period = "all", add_labels = TRUE) |>
dplyr::mutate(value =
value |>
stringr::str_replace_all(",","\\.") |>
as.numeric())
data_meso <-
datavisR::getdata(var_id = ids, ag = "meso", period = "all", add_labels = TRUE) |>
dplyr::mutate(value =
value |>
stringr::str_replace_all(",","\\.") |>
as.numeric())
data_micro <-
datavisR::getdata(var_id = ids, ag = "micro", period = "all", add_labels = TRUE) |>
dplyr::mutate(value =
value |>
stringr::str_replace_all(",","\\.") |>
as.numeric())
data_estado <-
datavisR::getdata(var_id = ids, ag = "estado", period = "all", add_labels = TRUE) |>
dplyr::mutate(value =
value |>
stringr::str_replace_all(",","\\.") |>
as.numeric())
ft_table <-
datavisR::geoagregall2() |>
dplyr::select(-period)
ft_table
my_data <-
ft_table |>
dplyr::left_join(
data_muni,
by = c("geo_id_municipio" = "geo_id",
"geo_name_municipio" = "geo_name")
) |>
dplyr::rename(value_municipio = value) |>
dplyr::left_join(
data_micro,
by = c("geo_id_micro" = "geo_id",
"geo_name_micro" = "geo_name",
"var_id" = "var_id",
"var_name" = "var_name",
"year" = "year",
"um_name" = "um_name",
"um_acronym" = "um_acronym",
"note" = "note")
) |>
dplyr::rename(value_micro = value) |>
dplyr::left_join(
data_meso,
by = c("geo_id_meso" = "geo_id",
"geo_name_meso" = "geo_name",
"var_id" = "var_id",
"var_name" = "var_name",
"year" = "year",
"um_name" = "um_name",
"um_acronym" = "um_acronym",
"note" = "note")
) |>
dplyr::rename(value_meso = value) |>
dplyr::left_join(
data_corede,
by = c("geo_id_corede" = "geo_id",
"geo_name_corede" = "geo_name",
"var_id" = "var_id",
"var_name" = "var_name",
"year" = "year",
"um_name" = "um_name",
"um_acronym" = "um_acronym",
"note" = "note")
) |>
dplyr::rename(value_corede = value) |>
dplyr::left_join(
data_estado,
by = c("geo_id_estado" = "geo_id",
"geo_name_estado" = "geo_name",
"var_id" = "var_id",
"var_name" = "var_name",
"year" = "year",
"um_name" = "um_name",
"um_acronym" = "um_acronym",
"note" = "note")
) |>
dplyr::rename(value_estado = value) |>
dplyr::filter(geo_name_municipio == "Gramado")
ft_table
library(devtools)
vars()
load_all()
vars()
#Development version of the package
library(devtools)
devtools::install_github("fernandoilcruz/datavisR")
#Load the package
library(datavisR)
vars_corede_ex_2013 <-
datavisR::vars() |>
dplyr::filter(
stringr::str_detect(var_name,"Idese"),
stringr::str_detect(string = var_name, pattern = "2013", negate = TRUE))
vars_corede_ex_2013
document()
library(datavisR)
datavisR::geoagreg(ag = "corede")
document()
datavisR::set_api_key("278c8a820d895f04d1c00805c225b031")
user_geo_id <-
datavisR::geoagregall2() |>
dplyr::filter (geo_name_municipio == "Porto Alegre") |>
dplyr::select(geo_id_municipio) |>
dplyr::pull()
user_var_id <-
datavisR::vars() |>
dplyr::filter(stringr::str_detect(var_name, c("Soja")) & stringr::str_detect(var_name, "Rendimento")) |>
dplyr::select(var_id) |>
dplyr::pull()
user_data <-
datavisR::getdata(
var_id = user_var_id,
geo_id = user_geo_id,
ag = "municipio",
period = "all",
add_labels = TRUE
)
#Or get data for all municipalities
user_data <-
datavisR::getdata(
var_id = user_var_id,
ag = "municipio",
period = "all",
add_labels = TRUE
)
#Or get data for all municipalities
user_data <-
datavisR::getdata(
var_id = user_var_id,
ag = "municipio",
period = "all",
add_labels = TRUE
)
user_data
vars_corede_ex_2013 <-
datavisR::vars() |>
dplyr::filter(
stringr::str_detect(var_name,"Idese"),
stringr::str_detect(string = var_name, pattern = "2013", negate = TRUE))
vars_corede_ex_2013
vars()
library(tidyverse)
vars()
dplyr::vars()
datavisR::vars()
